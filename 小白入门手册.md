# Android APK 打包 - 小白入门手册

## 一、什么是 Android SDK？

### 简单解释
Android SDK（Software Development Kit）是 Android 软件开发工具包，就像做菜需要锅碗瓢盆一样，开发 Android 应用需要 SDK 这个工具包。

### SDK 包含什么？
- **编译工具**：把代码转换成 APK 文件
- **模拟器**：在电脑上模拟 Android 手机
- **调试工具**：查找和修复代码错误
- **各种版本库**：支持不同版本的 Android 系统

### 为什么需要配置 SDK 路径？
打包脚本需要知道 SDK 的位置才能使用里面的工具，就像你需要告诉厨房在哪里才能做饭。

---

## 二、安装 Android SDK

### 方式1：安装 Android Studio（推荐，最简单）

#### 步骤：
1. **下载 Android Studio**
   - 访问官网：https://developer.android.com/studio
   - 下载 Windows 版本（约 1GB）

2. **安装**
   - 双击安装包
   - 点击 "Next" 直到完成
   - 安装时间约 10-20 分钟

3. **首次启动 Android Studio**
   - 选择 "Standard" 标准安装
   - 会自动下载 Android SDK（约 2-3GB）
   - 需要等待下载完成（可能需要 30 分钟）

4. **找到 SDK 路径**
   - 打开 Android Studio
   - 点击右上角齿轮图标 ⚙️ → Settings
   - 左侧找到 "Appearance & Behavior" → "System Settings" → "Android SDK"
   - 顶部会显示 **Android SDK Location**
   - 路径通常类似：
     ```
     C:\Users\你的用户名\AppData\Local\Android\Sdk
     C:\Program Files\Android\Android Studio
     ```

#### 复制 SDK 路径
- 点击路径后面的文件夹图标 📁
- 复制完整路径

---

### 方式2：仅安装 Android SDK（不安装完整 IDE）

#### 步骤：
1. **下载 Command Line Tools**
   - 访问：https://developer.android.com/studio#command-tools
   - 下载 "Command line tools only"

2. **解压并配置**
   - 解压到一个固定位置（如 `D:\Android\Sdk`）
   - 手动下载需要的 SDK 平台和工具
   - 配置环境变量

**注意**：此方式较复杂，不推荐小白使用。

---

## 三、安装 Java（JDK）

### 为什么需要 Java？
Android 开发和打包都需要 Java，就像做 Android 菜需要 Java 这种调料。

### 安装步骤：

#### 步骤1：下载 JDK
- 推荐版本：JDK 8 或 JDK 11（LTS长期支持版）
- 下载地址（任选其一）：
  - Oracle JDK：https://www.oracle.com/java/technologies/downloads/
  - OpenJDK（免费）：https://adoptium.net/

#### 步骤2：安装
- 双击安装包
- 按默认设置安装（一路 Next）

#### 步骤3：验证安装
1. 打开命令提示符（Win+R，输入 `cmd`，回车）
2. 输入命令：
   ```
   java -version
   ```
3. 如果看到版本号，说明安装成功

---

## 四、配置项目

### 配置 local.properties 文件

1. **打开文件**
   - 在项目根目录找到 `local.properties` 文件
   - 用记事本打开

2. **编辑 SDK 路径**
   - 找到这行：
     ```
     #sdk.dir=/path/to/android/sdk
     ```
   - 删除前面的 `#`
   - 替换为你的 SDK 路径：
     ```
     sdk.dir=C:\\Users\\你的用户名\\AppData\\Local\\Android\\Sdk
     ```
   - **注意**：路径中的反斜杠要双写 `\\`

3. **保存文件**

---

## 五、安装 Gradle（可选）

### 什么是 Gradle？
Gradle 是自动化构建工具，用于编译和打包 Android 应用。

### 通常不需要手动安装
- Android Studio 自带 Gradle
- 项目已包含 Gradle Wrapper（`gradlew.bat`）
- 打包脚本会自动使用项目自带的 Gradle

### 检查 Gradle 版本
- 打开文件：`gradle/wrapper/gradle-wrapper.properties`
- 查看版本：`distributionUrl`

---

## 六、检查环境清单

在运行打包脚本前，请确认：

- [ ] 已安装 Java JDK
- [ ] 已安装 Android Studio（包含 SDK）
- [ ] 已配置 local.properties 中的 SDK 路径
- [ ] 已安装 Python 3.x（运行打包脚本需要）

---

## 七、使用打包脚本

### 第一次运行（检查环境）

1. **双击运行 `build.bat`**
   - 脚本会自动检查环境
   - 如果缺少依赖，会提示安装

2. **看到的信息**：
   - ✅ Java 版本
   - ✅ SDK 路径检查
   - ✅ Gradle 检查

### 常见错误及解决

#### 错误1：`未找到Java`
**原因**：未安装或未配置环境变量
**解决**：
1. 安装 JDK（参考"安装 Java"章节）
2. 重启电脑
3. 再次运行脚本

#### 错误2：`local.properties中未找到sdk.dir配置`
**原因**：SDK 路径未配置
**解决**：
1. 打开 Android Studio
2. 复制 SDK 路径（参考"安装 Android Studio"章节）
3. 编辑 `local.properties` 文件（参考"配置项目"章节）

#### 错误3：`gradlew文件不存在` 或 `找不到或无法加载主类 org.gradle.wrapper.GradleWrapperMain`
**原因**：缺少 Gradle Wrapper 文件（gradlew.bat, gradle-wrapper.jar）
**解决**：

**方法 1：使用 Android Studio 生成（推荐）**
1. 打开 Android Studio
2. File → Open → 选择项目目录
3. 等待 Gradle 同步完成
4. Android Studio 会自动生成完整的 Gradle Wrapper 文件

**方法 2：手动安装 Gradle**
1. 下载 Gradle：https://gradle.org/install/
2. 解压到固定目录（如 `C:\gradle`）
3. 配置环境变量：
   - 右键"此电脑" → 属性 → 高级系统设置 → 环境变量
   - 新建系统变量 `GRADLE_HOME` = `C:\gradle`
   - 编辑 `Path` 变量，添加 `%GRADLE_HOME%\bin`
4. 运行 `build_with_gradle.bat` 脚本打包

**方法 3：从其他项目复制**
如果有其他正常工作的 Android 项目，可以复制以下文件：
- `gradlew.bat`
- `gradlew`
- `gradle/wrapper/gradle-wrapper.jar`
- `gradle/wrapper/gradle-wrapper.properties`

#### 错误4：`构建超时`
**原因**：网络慢或第一次下载依赖
**解决**：
1. 等待更长时间（最多 10 分钟）
2. 检查网络连接
3. 可能需要使用 VPN（如果在国内）

---

## 八、快速开始（3步搞定）

### 步骤1：安装必需软件（第一次）
1. 安装 Android Studio：https://developer.android.com/studio
2. 等待首次启动完成（SDK 下载）
3. 复制 SDK 路径

### 步骤2：配置项目（第一次）
1. 打开 `local.properties` 文件
2. 粘贴 SDK 路径：
   ```
   sdk.dir=C:\\Users\\你的用户名\\AppData\\Local\\Android\Sdk
   ```
3. 保存文件

### 步骤3：打包 APK
🎯 正确的构建 Debug APK 方法
方法 1：直接构建（不需要签名） ✅
菜单栏点击： Build → Build Bundle(s) / APK(s) → Build APK(s)

⚠️ 注意： 不要选 Generate Signed Bundle / APK，那是发布版本用的
等待构建完成

右下角会显示进度
构建完成后会弹窗提示：

点击 locate 即可找到 APK 文件
找到 APK：

code
应用
app/build/outputs/apk/debug/app-debug.apk

---

## 九、APK 文件在哪里？

构建成功后，APK 文件会在两个位置：

### 位置1：项目根目录（最方便）
- 直接在项目文件夹中
- 文件名：`app-debug.apk` 或 `app-release.apk`

### 位置2：构建输出目录
- 路径：`app/build/outputs/apk/debug/`
- 或：`app/build/outputs/apk/release/`

---

## 十、常见问题 FAQ

### Q1：Android SDK 多大？
A：完整 SDK 约 2-3GB，首次下载需要较长时间。

### Q2：可以不安装 Android Studio 吗？
A：理论上可以，但配置复杂，不建议小白操作。

### Q3：打包失败怎么办？
A：
1. 检查所有软件是否安装
2. 检查 SDK 路径是否正确
3. 查看 Python 脚本的错误提示
4. 可以尝试先 `clean` 再 `build`

### Q4：如何测试 APK？
A：
1. 在手机上安装 APK
2. 需要在手机设置中开启"允许安装未知来源应用"

### Q5：Debug 版和 Release 版有什么区别？
A：
- **Debug 版**：包含调试信息，文件较大，用于测试
- **Release 版**：经过优化，文件较小，用于发布

### Q6：每次打包都要安装软件吗？
A：不用，只需第一次安装配置好，之后直接运行脚本即可。

---

## 十一、环境配置完成示例

### 检查清单
```
✅ 已安装 Android Studio
✅ 已安装 Java JDK 11
✅ SDK 路径：C:\Users\YourName\AppData\Local\Android\Sdk
✅ local.properties 已配置
✅ Python 3.9 已安装
```

### 运行示例
```bash
# 1. 双击运行
build.bat

# 2. 看到输出
[INFO] 当前系统: Windows 10
[INFO] Python版本: 3.9.7
[INFO] Java版本: openjdk version "11.0.12"
[SUCCESS] local.properties配置检查通过
[SUCCESS] gradlew检查通过
[SUCCESS] 所有环境检查通过！

# 3. 选择操作
1. 构建Debug版本APK
请选择操作 (1-5): 1

# 4. 等待完成
[INFO] 开始构建debug版本APK...
[INFO] 执行命令: gradlew.bat assembleDebug
[SUCCESS] 构建成功！
[SUCCESS] APK文件: app\build\outputs\apk\debug\app-debug.apk
[SUCCESS] APK大小: 5.23 MB
```

---

## 十二、联系方式

如有问题，可以：
1. 查看错误信息的提示
2. 检查本手册的"常见错误及解决"章节
3. 搜索错误信息（推荐使用 Google）
4. 咨询有 Android 开发经验的同事

---

**最后更新**：2025年
**适用版本**：Android Studio 最新版
